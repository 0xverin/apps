"use strict";(("undefined"!=typeof self?self:this).webpackChunk_polkadot_apps=("undefined"!=typeof self?self:this).webpackChunk_polkadot_apps||[]).push([[4776],{53185:(e,r,n)=>{function t(e,r,n){return c(e,r,n),(new TextDecoder).decode(e.slice(r,r+n))}function o(e,r){return c(e,r,4),(e[r]|e[r+1]<<8|e[r+2]<<16)+16777216*e[r+3]}function s(e,r,n){c(e,r,1),e[r]=255&n}function i(e,r,n){c(e,r,4),e[r+3]=n>>>24&255,e[r+2]=n>>>16&255,e[r+1]=n>>>8&255,e[r]=255&n}function c(e,r,n){if(!Number.isInteger(r)||r<0)throw new RangeError;if(r+n>e.length)throw new RangeError}n.d(r,{Cg:()=>s,nm:()=>o,v7:()=>i,yV:()=>t})},14915:(e,r,n)=>{n.d(r,{hY:()=>o.h,LX:()=>u,Ps:()=>p,t_:()=>h,BL:()=>f});var t=n(53185),o=n(42029),s=n(8111),i=n(9810);function c(e,r){return n=this,t=void 0,a=function*(){const n=yield r.trustedBase64DecodeAndZlibInflate(i.Z);let t;const c=Object.assign({performanceNow:r.performanceNow,connect:r.connect,onPanic:r=>{throw t(),e.onWasmPanic(r),new Error}},e),a={envVars:[],getRandomValues:r.getRandomValues,onProcExit:r=>{throw t(),e.onWasmPanic(`proc_exit called: ${r}`),new Error}},{imports:l,killAll:u}=(0,o.Z)(c);t=u;const p=(yield WebAssembly.instantiate(n,{smoldot:l,wasi_snapshot_preview1:(0,s.Z)(a)})).instance;return c.instance=p,a.instance=p,p},new((c=void 0)||(c=Promise))((function(e,r){function o(e){try{i(a.next(e))}catch(e){r(e)}}function s(e){try{i(a.throw(e))}catch(e){r(e)}}function i(r){var n;r.done?e(r.value):(n=r.value,n instanceof c?n:new c((function(e){e(n)}))).then(o,s)}i((a=a.apply(n,t||[])).next())}));var n,t,c,a}var a=n(10027),l=function(e,r,n,t){return new(n||(n=Promise))((function(o,s){function i(e){try{a(t.next(e))}catch(e){s(e)}}function c(e){try{a(t.throw(e))}catch(e){s(e)}}function a(e){var r;e.done?o(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(i,c)}a((t=t.apply(e,r||[])).next())}))};class u extends Error{constructor(e){super(e)}}class p extends Error{constructor(){super("JSON-RPC request is malformed")}}class h extends Error{constructor(){super("JSON-RPC requests queue is full")}}function f(e,r){let n;const o={},s={name:null},i={printError:!0};let f=new Map;const d={onWasmPanic:e=>{if(o.error=new u(e),i.printError){console.error("Smoldot has panicked"+(s.name?" while executing task `"+s.name+"`":"")+". This is a bug in smoldot. Please open an issue at https://github.com/paritytech/smoldot/issues with the following message:\n"+e);for(const e of Array.from(f.values())){for(const r of e.jsonRpcResponsesPromises)r.reject(o.error);e.jsonRpcResponsesPromises=[]}}},logCallback:(r,n,t)=>{e.logCallback(r,n,t)},jsonRpcResponsesNonEmptyCallback:e=>{const r=f.get(e).jsonRpcResponsesPromises;for(;0!==r.length;)r.shift().resolve()},currentTaskCallback:e=>{s.name=e},cpuRateLimit:e.cpuRateLimit};function w(e){return l(this,void 0,void 0,(function*(){return n.initialized?e(n.instance):n.promise.then((r=>e(r)))}))}return n={initialized:!1,promise:c(d,r).then((t=>{let s=Math.round(4294967295*d.cpuRateLimit);s<0&&(s=0),s>4294967295&&(s=4294967295),Number.isFinite(s)||(s=4294967295);const[i,c]=r.registerShouldPeriodicallyYield((e=>{if(n.initialized&&!o.error)try{n.instance.exports.set_periodically_yield(e?1:0)}catch(e){}}));return t.exports.init(e.maxLogLevel,e.enableCurrentTask?1:0,s,i?1:0),n={initialized:!0,instance:t,unregisterCallback:c},t}))},{request:(e,r)=>{if(!n.initialized)throw new Error("Internal error");if(o.error)throw o.error;let t;try{const o=(new TextEncoder).encode(e),s=n.instance.exports.alloc(o.length)>>>0;new Uint8Array(n.instance.exports.memory.buffer).set(o,s),t=n.instance.exports.json_rpc_send(s,o.length,r)>>>0}catch(e){throw console.assert(o.error),o.error}switch(t){case 0:break;case 1:throw new p;case 2:throw new h;default:throw new Error("Internal error: unknown json_rpc_send error code: "+t)}},nextJsonRpcResponse:e=>l(this,void 0,void 0,(function*(){if(!n.initialized)throw new Error("Internal error");for(;;){if(o.error)throw o.error;try{const r=new Uint8Array(n.instance.exports.memory.buffer),o=n.instance.exports.json_rpc_responses_peek(e)>>>0,s=t.nm(r,o)>>>0,i=t.nm(r,o+4)>>>0;if(0!==i){const o=t.yV(r,s,i);return n.instance.exports.json_rpc_responses_pop(e),o}}catch(e){throw console.assert(o.error),o.error}yield new Promise(((r,n)=>{f.get(e).jsonRpcResponsesPromises.push({resolve:()=>r(void 0),reject:n})}))}})),addChain:(e,r,n,s)=>w((i=>{if(o.error)throw o.error;try{const o=(new TextEncoder).encode(e),c=i.exports.alloc(o.length)>>>0;new Uint8Array(i.exports.memory.buffer).set(o,c);const a=(new TextEncoder).encode(r),l=i.exports.alloc(a.length)>>>0;new Uint8Array(i.exports.memory.buffer).set(a,l);const u=n.length,p=i.exports.alloc(4*u)>>>0;for(let e=0;e<n.length;++e)t.v7(new Uint8Array(i.exports.memory.buffer),p+4*e,n[e]);const h=i.exports.add_chain(c,o.length,l,a.length,s?0:1,p,u);if(0!=i.exports.chain_is_ok(h))return console.assert(!f.has(h)),f.set(h,{jsonRpcResponsesPromises:new Array}),{success:!0,chainId:h};{const e=i.exports.chain_error_len(h)>>>0,r=i.exports.chain_error_ptr(h)>>>0,n=t.yV(new Uint8Array(i.exports.memory.buffer),r,e);return i.exports.remove_chain(h),{success:!1,error:n}}}catch(e){throw console.assert(o.error),o.error}})),removeChain:e=>{if(!n.initialized)throw new Error("Internal error");if(o.error)throw o.error;console.assert(f.has(e));for(const{reject:r}of f.get(e).jsonRpcResponsesPromises)r(new a.A_);f.delete(e);try{n.instance.exports.remove_chain(e)}catch(e){throw console.assert(o.error),o.error}},startShutdown:()=>w((e=>{if(!o.error){n.initialized&&n.unregisterCallback();try{i.printError=!1,e.exports.start_shutdown()}catch(e){}}}))}}}}]);